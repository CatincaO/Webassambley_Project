<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
</head>

<body>
  <input type="number" id="n1" /><br /><br />

  <input type="number" id="n2" /><br /><br />
  <input type="button" value="Add" onclick="callAdd()" /><br><br>

  <input type="number" id="n3" /><br /><br />

  <input type="number" id="n4" /><br /><br />
  <input type="button" value="Format Int" onclick="callIntegerFormat()" /><br><br>

  <input type="number" id="n5" /><br /><br />

  <input type="number" id="n6" /><br /><br />

  <input type="button" value="Format Float" onclick="callFloatFormat()" /><br><br>
  <div>
    <p>API BELOW</p>
    <input type="number" id="api1" /><br /><br />
    <input type="number" id="api2" /><br /><br />
    <input type="button" value="Call API" onclick="callApiIntegerFormat()" />
    <p>Result</p>
    <input type="text" id="result" /><br /><br />

  </div>
  <script>
    function callApiIntegerFormat() {
      var x = parseFloat(document.getElementById('api1').value);
      var y = parseFloat(document.getElementById('api2').value);

      var startTime = performance.now();
      fetch("https://localhost:7160/FormatInteger", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          value: x,
          digits: y
        }
        ),
      })
        .then(function (response) {
          return response.json()
        })
        .then(function (data) {
          console.log(data);
          var endTime = performance.now();
          console.log(`Call to API took ${endTime - startTime} milliseconds`);

          document.getElementById('result').value=data.value;
        })
    }

    function callAdd() {
      var x = parseFloat(document.getElementById('n1').value);
      var y = parseFloat(document.getElementById('n2').value);
      alert(x + y);
      const result = Module.ccall('Add',
        'number',
        ['number', 'number'],
        [x, y]);
      console.log(`Result: ${result}`);
    }

    function callIntegerFormat() {
      var x = parseFloat(document.getElementById('n3').value);
      var y = parseFloat(document.getElementById('n4').value);
      var startTime = performance.now();

      const result = Module.ccall('formatInt',
        'string',
        ['number', 'number'],
        [x, y]);

        var endTime = performance.now();
        console.log(`Call to Webassembly took ${endTime - startTime} milliseconds`);
      console.log(`Result: ${result}`);
    }
    function callFloatFormat() {
      var x = document.getElementById('n5').value;
      var y = parseInt(document.getElementById('n6').value);

      const result = Module.ccall('floatFormat',
        'string',
        ['string', 'number'],
        [x, y]);

      console.log(`Result: ${result}`);
    }

  </script>
  <script src="js_plumbing.js"></script>
</body>

</html>